---
title: "Class06: R Functions"
author: "Xiaoxuan Teng"
date: 01/26/2024
format: pdf
editor: visual
---

# Our first simple silly function

All functions in R have 3 parts. They have:

- a name
- input arguments (none, one or more)
- a body

A function to add two numbers

```{r sillyfun}
sillyadd <- function(x, y = 1) {
  x + y
}
```

Let me try out this function.

```{r}
sillyadd(10)
```

# Let's do sth more useful

```{r}
# Example 1
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
```

```{r}
mean(student1)
```

```{r}
min(student1)
which.min(student1)
#which.min(student2)
#which.min(student3)
```

```{r}
student1[-8]
```

```{r}
x <- student2
# Find lowest value
ind <- which.min(x)
# Exclude lowest value and find mean
mean(x[-ind], na.rm = T)
```

```{r}
student3
x <- student3
# Find lowest value
ind <- which.min(x)
# Exclude lowest value and find mean
mean(x[-ind], na.rm = T)
```

Find and replace the NA values with zero

```{r}
x <- 1:5
x
x[x == 3] <- 10000
x
```

```{r}
x <- student2
x
x[is.na(x)] <- 0
x
```

```{r}
x <- student3
x[is.na(x)] <- 0
mean(x[-which.min(x)])
```


```{r}
x <- student3
x[is.na(x)] <- 0
ind <- which.min(x)
mean(x[-ind])
```



```{r}
grade_dropmin <- function(x) {
  x[is.na(x)] <- 0
  x <- x[-which.min(x)]
  mean(x)
}
```



```{r}
grade_dropmin(student1)
```

Read a class grade book CSV file from here: "https://tinyurl.com/gradeinput"

```{r}
url <- "https://tinyurl.com/gradeinput"
gradebook <- read.csv(url, row.names = 1)
```

Now use our `grade()` function to grade the whole class...

We can "apply" our new `grade()` function over either the rows or the coulmns of the gradebook. with MARGIN = 1 or MARGIN = 2

```{r}
results <- apply(gradebook, 1, FUN = grade_dropmin)
results
```

> **Q2.** Using your grade() function and the supplied gradebook, Who is the top scoring student overall in the gradebook? [3pts]

```{r}
which.max(results)
```

> **Q3.** From your analysis of the gradebook, which homework was toughest on students (i.e. obtained the lowest scores overall? [2pts]

```{r}
toughest <- apply(gradebook, 2, mean, na.rm = T)
toughest
which.min(toughest)
```


```{r}
grade <- function(x, drop.lowest=TRUE) {
  x[is.na(x)] <- 0
  if(drop.lowest){
  x <- x[-which.min(x)]
  ans <- mean(x)
  }
  else{
    ans <- mean(x)
  }
  ans
}
```


```{r}
toughest <- apply(gradebook, 2, grade, drop.lowest = F)
toughest
which.min(toughest)
```

```{r}
plotme <- function(x, ...){
  plot(x, ...)
}

plotme(1:10, col="blue", typ="l")
```




> **Q4.** Optional Extension: From your analysis of the gradebook, which homework was most predictive of overall score (i.e. highest correlation with average grade score)? [1pt]

```{r}
mask <- gradebook
mask[is.na(mask)] <- 0

cor(mask$hw5, results)
cor(mask$hw4, results)
cor(mask$hw3, results)
cor(mask$hw2, results)
cor(mask$hw1, results)

correlation <- apply(mask, 2, cor, y = results)
correlation
which.max(correlation)
```














