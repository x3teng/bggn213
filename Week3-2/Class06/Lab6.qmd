---
title: "Lab6: R Function Lab"
author: "Xiaoxuan Teng (PID: A69028742)"
date: 01/28/2024
format: pdf
---
```{r}
# Example input vectors to start with
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
```

> **Q1.** Write a function grade() to determine an overall grade from a vector of student homework 
assignment scores dropping the lowest single score. If a student misses a homework (i.e. has an
NA value) this can be used as a score to be potentially dropped. Your final function should be
adquately explained with code comments and be able to work on an example class gradebook
such as this one in CSV format: “https://tinyurl.com/gradeinput” [3pts]

```{r}
# For student 2
x <- student2
# Find lowest value
ind <- which.min(x)
# Exclude lowest value and find mean
mean(x[-ind], na.rm = T)
```

```{r}
# For student 3
student3
x <- student3
# Find lowest value
ind <- which.min(x)
# Exclude lowest value and find mean
mean(x[-ind], na.rm = T)

# There are 7 NA values in this vector
# There is no value left when exclude lowest and NA values
# So assign 0 to NA value
x <- student3
x[is.na(x)] <- 0
mean(x[-which.min(x)])
```
```{r}
# grade() function: get an overall grade (mean grade) after dropping the lowest score
grade <- function(x) {
  x[is.na(x)] <- 0  # assign 0 to NA value in x
  x <- x[-which.min(x)] # Exclude lowest value
  mean(x) # find mean
}
```

```{r}
# import a csv file named "gradebook"
url <- "https://tinyurl.com/gradeinput"
gradebook <- read.csv(url, row.names = 1)

# Use the grade() function to grade each students (row) in "gradebook"
results <- apply(gradebook, 1, FUN = grade)
results
```

> **Q2.** Using your grade() function and the supplied gradebook, Who is the top scoring student overall in the gradebook? [3pts]

```{r}
# Determine the index of student number with highest average scores
which.max(results)
```
So **student 18** is the top scoring student overall in the gradebook.



> **Q3.** From your analysis of the gradebook, which homework was toughest on students (i.e. obtained the lowest scores overall? [2pts]

```{r}
# Apply mean() function to each column to get the average score for each homework
# Exclude all NA values
toughest <- apply(gradebook, 2, mean, na.rm = T)
toughest
# Find the homework index with the lowest average score using which.min()
which.min(toughest)
```
So **hw3** was the toughest on students.

> **Q4.** Optional Extension: From your analysis of the gradebook, which homework was most predictive of overall score (i.e. highest correlation with average grade score)? [1pt]

```{r}
# Generate a data.frame called mask where the NA is replaced by 0
mask <- gradebook
mask[is.na(mask)] <- 0
# Apply cor() function to find the correlation of average grade and grade for each hw
correlation <- apply(mask, 2, cor, y = results)
correlation
# Find the hw index with the highest correlation using which.max()
which.max(correlation)
```
So **hw5** was the most predictive of overall score.





